<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>Clinic Portal</title>

  <!-- App CSS -->
  <link rel="stylesheet" href="/css/app.css" />
</head>
<body>
  <div id="app" class="flex">
    <aside id="sidebar" class="w-56 border-r p-4">
      <h2 class="text-lg font-semibold mb-4">Clinic Portal</h2>
      <nav>
        <ul class="space-y-2">
          <li><a href="#" data-nav="scheduler">Scheduler</a></li>
          <li><a href="#" data-nav="patient">Patient Search</a></li>
          <li><a href="#" data-nav="billing">Billing</a></li>
          <li><a href="#" data-nav="reports">Reports</a></li>
        </ul>
      </nav>
    </aside>

    <!-- ✅ Unified ViewManager root container -->
    <main id="app-root" class="flex-1 p-4">
      <div id="view-loading" class="hidden">Loading...</div>
    </main>
  </div>

  <!-- ✅ Global modal container -->
  <div id="global-modal-container" data-loaded="false"></div>

  <!-- ============================= -->
  <!--          Scripts              -->
  <!-- ============================= -->

  <!-- FullCalendar -->
  <script src="/libs/fullcalendar/index.global.min.js"></script>

  <!-- Core managers -->
  <script src="/js/view-manager.js"></script>
  <script src="/js/current-appointment-data.js"></script>
  <script src="/js/modal-manager.js"></script>

  <!-- Bridge for legacy FragmentLoader references -->
  <script>
    window.FragmentLoader = {
      load: (section, params = {}) => {
        const q = new URLSearchParams(params).toString();
        const url = `/fragments/${section}${q ? "?" + q : ""}`;
        return window.ViewManager.loadView(section, url);
      },
    };
  </script>

  <!-- App boot -->
  <script src="/js/app.js"></script>

  <!-- Feature modules -->
  <script src="/js/appointment.js"></script>
  <script src="/js/calendar.js"></script>
  <script src="/js/patient-search.js"></script>
</body>
</html>
